<!-- _includes/prev_next.html -->
{%- comment -%}
Prev/Next cards for logs (collection: site.logs)
Goal: restore the styled cards at the bottom of each log page.
Previous = older log
Next     = newer log
{%- endcomment -%}

{%- assign logs_sorted = site.logs | sort: "date" -%}
{%- assign current_url = page.url -%}

{%- assign current_index = nil -%}
{%- for item in logs_sorted -%}
  {%- if item.url == current_url -%}
    {%- assign current_index = forloop.index0 -%}
  {%- endif -%}
{%- endfor -%}

{%- if current_index != nil -%}
  {%- assign prev_index = current_index | minus: 1 -%}
  {%- assign next_index = current_index | plus: 1 -%}

  {%- assign prev_item = nil -%}
  {%- assign next_item = nil -%}

  {%- if prev_index >= 0 -%}
    {%- assign prev_item = logs_sorted[prev_index] -%}
  {%- endif -%}

  {%- if next_index < logs_sorted.size -%}
    {%- assign next_item = logs_sorted[next_index] -%}
  {%- endif -%}

  {%- if prev_item or next_item -%}
    <nav class="finch-pager finch-pager--log" aria-label="Log navigation">
      {%- if prev_item -%}
        <a class="finch-pager__card finch-pager__card--prev" href="{{ prev_item.url | relative_url }}">
          <span class="finch-pager__dir">Previous</span>
          <span class="finch-pager__title">{{ prev_item.title }}</span>
          <span class="finch-pager__meta">
            <span class="finch-pager__id">{{ prev_item.log_id | default: '' }}</span>
            <span class="finch-pager__dot" aria-hidden="true">·</span>
            <span class="finch-pager__date">{{ prev_item.date | date: "%Y-%m-%d" }}</span>
          </span>
        </a>
      {%- else -%}
        <div class="finch-pager__card finch-pager__card--empty" aria-hidden="true"></div>
      {%- endif -%}

      {%- if next_item -%}
        <a class="finch-pager__card finch-pager__card--next" href="{{ next_item.url | relative_url }}">
          <span class="finch-pager__dir">Next</span>
          <span class="finch-pager__title">{{ next_item.title }}</span>
          <span class="finch-pager__meta">
            <span class="finch-pager__id">{{ next_item.log_id | default: '' }}</span>
            <span class="finch-pager__dot" aria-hidden="true">·</span>
            <span class="finch-pager__date">{{ next_item.date | date: "%Y-%m-%d" }}</span>
          </span>
        </a>
      {%- else -%}
        <div class="finch-pager__card finch-pager__card--empty" aria-hidden="true"></div>
      {%- endif -%}
    </nav>
  {%- endif -%}
{%- endif -%}