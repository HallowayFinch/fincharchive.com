{% comment %} Global head include for meta, previews, and feeds {% endcomment %}
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

{%- assign _title = page.title | default: site.title -%}
<title>{{ _title }}{% if page.title %} · {{ site.title }}{% endif %}</title>

{%- assign _desc = page.excerpt | default: site.description -%}
<meta name="description" content="{{ _desc | strip_html | strip_newlines | truncate: 160 }}">

{%- comment %}
Canonical URL and image
- og_image falls back to page.hero_image (for logs) then to a site default
{%- endcomment -%}
{%- assign _url  = page.canonical_url | default: page.url | absolute_url -%}
{%- assign _img  = page.og_image | default: page.hero_image | default: '/assets/og/og-default.png' | absolute_url -%}

<link rel="canonical" href="{{ _url }}">

{%- comment %}
Open Graph / Twitter
- og:type = "article" for collections (logs, field-notes), else "website"
- Includes published/modified times when available
{%- endcomment -%}
{%- assign _is_article = false -%}
{%- if page.collection == 'logs' or page.collection == 'field-notes' -%}
  {%- assign _is_article = true -%}
{%- endif -%}

<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:type" content="{% if _is_article %}article{% else %}website{% endif %}">
<meta property="og:title" content="{{ _title }}">
<meta property="og:description" content="{{ _desc | strip_html | strip_newlines }}">
<meta property="og:url" content="{{ _url }}">
<meta property="og:image" content="{{ _img }}">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ _title }}">
<meta name="twitter:description" content="{{ _desc | strip_html | strip_newlines }}">
<meta name="twitter:image" content="{{ _img }}">

{%- if _is_article and page.date -%}
  <meta property="article:published_time" content="{{ page.date | date_to_xmlschema }}">
{%- endif -%}
{%- if _is_article and page.last_modified_at -%}
  <meta property="article:modified_time" content="{{ page.last_modified_at | date_to_xmlschema }}">
{%- endif -%}

{%- comment %} Feeds (Logs + Field Notes) {%- endcomment -%}
<link rel="alternate" type="application/rss+xml" title="{{ site.title }} — Logs" href="{{ '/logs.xml' | absolute_url }}">
<link rel="alternate" type="application/rss+xml" title="{{ site.title }} — Field Notes" href="{{ '/field-notes/feed.xml' | absolute_url }}">

{%- comment %} Icons / meta {%- endcomment -%}
<link rel="icon" href="{{ '/favicon.ico' | relative_url }}">
<meta name="theme-color" content="#000000">

{%- comment %} Robots override (optional per-page) {%- endcomment -%}
{%- if page.noindex -%}
  <meta name="robots" content="noindex, nofollow">
{%- endif -%}

<meta name="generator" content="Jekyll">