{%- assign share_url = page.url | absolute_url -%}
<div class="share-row">
  <button class="btn btn-ghost" id="share-btn" type="button" data-url="{{ share_url }}">
    <svg class="icon" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
      <path fill="currentColor" d="M18 8a3 3 0 10-2.83-4H15a3 3 0 102.83 4H18zM6 14a3 3 0 10-2.83 4H3a3 3 0 102.83-4H6zm12 0a3 3 0 10-2.83 4H15a3 3 0 102.83-4H18zM8.59 13l6.82-3.41-.9-1.8L7.7 11.2l.89 1.8z"/>
    </svg>
    <span>Share</span>
  </button>
  <span class="share-toast" id="share-toast" role="status" aria-live="polite"></span>
</div>

<script>
(function(){
  var btn = document.getElementById('share-btn');
  var toast = document.getElementById('share-toast');
  if(!btn) return;
  var url = btn.getAttribute('data-url');
  btn.addEventListener('click', async function(){
    try{
      if (navigator.share) {
        await navigator.share({ url, title: document.title });
        return;
      }
      await navigator.clipboard.writeText(url);
      toast.textContent = 'Link copied';
      btn.disabled = true;
      setTimeout(function(){ toast.textContent=''; btn.disabled=false; }, 1400);
    }catch(e){
      // Fallback: select+copy via prompt
      window.prompt('Copy link', url);
    }
  });
})();
</script>